<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Court plots | Volleyball analytics snippets</title>
  <meta name="description" content="Notes and snippets of R code for volleyball analytics" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Court plots | Volleyball analytics snippets" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://openvolley.github.io/volley-analytics-snippets//images/cover.png" />
  <meta property="og:description" content="Notes and snippets of R code for volleyball analytics" />
  <meta name="github-repo" content="openvolley/volley-analytics-snippets" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Court plots | Volleyball analytics snippets" />
  
  <meta name="twitter:description" content="Notes and snippets of R code for volleyball analytics" />
  <meta name="twitter:image" content="https://openvolley.github.io/volley-analytics-snippets//images/cover.png" />

<meta name="author" content="Ben Raymond, Adrien Ickowicz " />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="indicators-and-statistics.html"/>
<link rel="next" href="live-scouting.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="journal.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#openvolley"><i class="fa fa-check"></i>openvolley</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i>Contributing</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contribution-guidelines"><i class="fa fa-check"></i>Contribution guidelines</a></li>
</ul></li>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#contributors-and-acknowledgements"><i class="fa fa-check"></i><b>1.1</b> Contributors and acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>2</b> Setup</a>
<ul>
<li class="chapter" data-level="2.1" data-path="setup.html"><a href="setup.html#example-data"><i class="fa fa-check"></i><b>2.1</b> Example data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reading-files.html"><a href="reading-files.html"><i class="fa fa-check"></i><b>3</b> Reading files</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reading-files.html"><a href="reading-files.html#datavolley"><i class="fa fa-check"></i><b>3.1</b> DataVolley</a></li>
<li class="chapter" data-level="3.2" data-path="reading-files.html"><a href="reading-files.html#vbstats"><i class="fa fa-check"></i><b>3.2</b> VBStats</a></li>
<li class="chapter" data-level="3.3" data-path="reading-files.html"><a href="reading-files.html#reading-multiple-files"><i class="fa fa-check"></i><b>3.3</b> Reading multiple files</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="file-validation.html"><a href="file-validation.html"><i class="fa fa-check"></i><b>4</b> File validation</a></li>
<li class="chapter" data-level="5" data-path="general-notes-and-tips.html"><a href="general-notes-and-tips.html"><i class="fa fa-check"></i><b>5</b> General notes and tips</a></li>
<li class="chapter" data-level="6" data-path="data-augmentation.html"><a href="data-augmentation.html"><i class="fa fa-check"></i><b>6</b> Data augmentation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-augmentation.html"><a href="data-augmentation.html#the-setter-of-a-given-attack"><i class="fa fa-check"></i><b>6.1</b> The setter of a given attack</a></li>
<li class="chapter" data-level="6.2" data-path="data-augmentation.html"><a href="data-augmentation.html#setter-player-ids"><i class="fa fa-check"></i><b>6.2</b> Setter player IDs</a></li>
<li class="chapter" data-level="6.3" data-path="data-augmentation.html"><a href="data-augmentation.html#reception-quality"><i class="fa fa-check"></i><b>6.3</b> Reception quality</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="filtering-and-subsetting.html"><a href="filtering-and-subsetting.html"><i class="fa fa-check"></i><b>7</b> Filtering and subsetting</a>
<ul>
<li class="chapter" data-level="7.1" data-path="filtering-and-subsetting.html"><a href="filtering-and-subsetting.html#attack-after-perfect-or-good-reception"><i class="fa fa-check"></i><b>7.1</b> Attack after perfect or good reception</a></li>
<li class="chapter" data-level="7.2" data-path="filtering-and-subsetting.html"><a href="filtering-and-subsetting.html#players-on-court"><i class="fa fa-check"></i><b>7.2</b> Players on court</a></li>
<li class="chapter" data-level="7.3" data-path="filtering-and-subsetting.html"><a href="filtering-and-subsetting.html#first-transition-attack"><i class="fa fa-check"></i><b>7.3</b> First transition attack</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="indicators-and-statistics.html"><a href="indicators-and-statistics.html"><i class="fa fa-check"></i><b>8</b> Indicators and statistics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="indicators-and-statistics.html"><a href="indicators-and-statistics.html#expected-sideout-rate"><i class="fa fa-check"></i><b>8.1</b> Expected sideout rate</a></li>
<li class="chapter" data-level="8.2" data-path="indicators-and-statistics.html"><a href="indicators-and-statistics.html#expected-breakpoint-rate"><i class="fa fa-check"></i><b>8.2</b> Expected breakpoint rate</a></li>
<li class="chapter" data-level="8.3" data-path="indicators-and-statistics.html"><a href="indicators-and-statistics.html#set-assist-rate"><i class="fa fa-check"></i><b>8.3</b> Set assist rate</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="court-plots.html"><a href="court-plots.html"><i class="fa fa-check"></i><b>9</b> Court plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="court-plots.html"><a href="court-plots.html#background-on-location-information"><i class="fa fa-check"></i><b>9.1</b> Background on location information</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="court-plots.html"><a href="court-plots.html#zones-and-subzones"><i class="fa fa-check"></i><b>9.1.1</b> Zones and subzones</a></li>
<li class="chapter" data-level="9.1.2" data-path="court-plots.html"><a href="court-plots.html#coordinates"><i class="fa fa-check"></i><b>9.1.2</b> Coordinates</a></li>
<li class="chapter" data-level="9.1.3" data-path="court-plots.html"><a href="court-plots.html#vbstats-1"><i class="fa fa-check"></i><b>9.1.3</b> VBStats</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="court-plots.html"><a href="court-plots.html#plotting-by-zone-or-subzone"><i class="fa fa-check"></i><b>9.2</b> Plotting by zone or subzone</a></li>
<li class="chapter" data-level="9.3" data-path="court-plots.html"><a href="court-plots.html#plotting-by-cone"><i class="fa fa-check"></i><b>9.3</b> Plotting by cone</a></li>
<li class="chapter" data-level="9.4" data-path="court-plots.html"><a href="court-plots.html#plotting-by-line-segment"><i class="fa fa-check"></i><b>9.4</b> Plotting by line segment</a></li>
<li class="chapter" data-level="9.5" data-path="court-plots.html"><a href="court-plots.html#heatmaps"><i class="fa fa-check"></i><b>9.5</b> Heatmaps</a></li>
<li class="chapter" data-level="9.6" data-path="court-plots.html"><a href="court-plots.html#changing-direction"><i class="fa fa-check"></i><b>9.6</b> Changing direction</a></li>
<li class="chapter" data-level="9.7" data-path="court-plots.html"><a href="court-plots.html#plotting-mid-coordinates"><i class="fa fa-check"></i><b>9.7</b> Plotting mid-coordinates</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="live-scouting.html"><a href="live-scouting.html"><i class="fa fa-check"></i><b>10</b> Live scouting</a>
<ul>
<li class="chapter" data-level="10.1" data-path="live-scouting.html"><a href="live-scouting.html#shiny-on-the-scout-laptop"><i class="fa fa-check"></i><b>10.1</b> Shiny on the scout laptop</a></li>
<li class="chapter" data-level="10.2" data-path="live-scouting.html"><a href="live-scouting.html#shiny-on-the-bench-laptop"><i class="fa fa-check"></i><b>10.2</b> Shiny on the bench laptop</a></li>
<li class="chapter" data-level="10.3" data-path="live-scouting.html"><a href="live-scouting.html#send-the-file-via-the-internet"><i class="fa fa-check"></i><b>10.3</b> Send the file via the internet</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="odds-and-ends.html"><a href="odds-and-ends.html"><i class="fa fa-check"></i><b>11</b> Odds and ends</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Volleyball analytics snippets</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="court-plots" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Court plots<a href="court-plots.html#court-plots" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="background-on-location-information" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Background on location information<a href="court-plots.html#background-on-location-information" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="zones-and-subzones" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Zones and subzones<a href="court-plots.html#zones-and-subzones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Scouts using DataVolley make use of zones (and optionally subzones) for all skills. Cones can alternatively be used for attack directions (instead of recording the end zone). Attacks cannot be scouted with both zones <em>and</em> cones in one file, DataVolley supports only one or the other. The zone/cone associated with each action is stored in the DataVolley file as the zone/cone number, without any inherent direction (side of the court) and without any actual location information. To plot the location of an action on a court diagram, we first generate actual court coordinates using the <code>dv_xy()</code> function. We pass it the zone number and which end of the court diagram (upper or lower) we wish to plot onto — let’s say an action from zone 4:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="court-plots.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dv_xy</span>(<span class="at">zones =</span> <span class="dv">4</span>, <span class="at">end =</span> <span class="st">&quot;lower&quot;</span>)</span>
<span id="cb29-2"><a href="court-plots.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   x y</span></span>
<span id="cb29-3"><a href="court-plots.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1 3</span></span></code></pre></div>
<p>So zone 4 is located at <code>x = 1</code> and <code>y = 3</code>. The coordinate system used by <code>openvolley</code> packages looks like this:</p>
<p><img src="_main_files/figure-html/courtexample-1.png" width="672" /></p>
</div>
<div id="coordinates" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Coordinates<a href="court-plots.html#coordinates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Actions can also be scouted with coordinates (the more precise locations, that are entered with the mouse click on the small court diagram). These are stored separately to the zone information in the DataVolley file. Coordinates can be used alongside of zones or cones, but not all scouts use coordinates. Coordinates are stored in the file as a single index from 1-10000, where 1 starts in the bottom-left on the lower side of the court diagram, across the row to 100 at the bottom-right, and it fills row-wise until 9901 is the top-left on the upper side of the court diagram and 10000 is the top-right. That covers both sides of the court, so coordinates are stored in the dvw file with an actual court location (and side) associated with them.</p>
<p>When a DataVolley file is read into R using <code>dv_read</code>, these coordinates are stored without alteration in the <code>start_coordinate</code>, <code>mid_coordinate</code>, and <code>end_coordinate</code> columns. They are also converted to the same reference system shown above (using the <code>dv_index2xy()</code> function), and these values stored in the <code>start_coordinate_x</code>, <code>start_coordinate_y</code>, <code>mid_coordinate_x</code>, <code>mid_coordinate_y</code>, <code>end_coordinate_x</code>, and <code>end_coordinate_y</code> columns.</p>
</div>
<div id="vbstats-1" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> VBStats<a href="court-plots.html#vbstats-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>VBStats files use only coordinates internally, and on a different native grid to the DataVolley grid. When a VBStats file is read into R using the <code>pv_read</code> function, these coordinates are converted to the same coordinate system used above. Each coordinate is also converted to its corresponding zone and subzone, so these are also available when using VBStats files in R, even though VBStats itself doesn’t allow scouting with zones and subzones.</p>
</div>
</div>
<div id="plotting-by-zone-or-subzone" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Plotting by zone or subzone<a href="court-plots.html#plotting-by-zone-or-subzone" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="court-plots.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-2"><a href="court-plots.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb30-3"><a href="court-plots.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="court-plots.html#cb30-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">dv_read</span>(<span class="fu">dv_example_file</span>(<span class="dv">1</span>))</span>
<span id="cb30-5"><a href="court-plots.html#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="court-plots.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate attack frequency by zone, per team</span></span>
<span id="cb30-7"><a href="court-plots.html#cb30-7" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">plays</span>(x)</span>
<span id="cb30-8"><a href="court-plots.html#cb30-8" aria-hidden="true" tabindex="-1"></a>attack_rate <span class="ot">&lt;-</span> px <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(skill <span class="sc">==</span> <span class="st">&quot;Attack&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="court-plots.html#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(team, start_zone) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n_attacks =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="court-plots.html#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rate =</span> n_attacks<span class="sc">/</span><span class="fu">sum</span>(n_attacks)) <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb30-11"><a href="court-plots.html#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="court-plots.html#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="do">## add x, y coordinates associated with the zones</span></span>
<span id="cb30-13"><a href="court-plots.html#cb30-13" aria-hidden="true" tabindex="-1"></a>attack_rate <span class="ot">&lt;-</span> <span class="fu">cbind</span>(attack_rate, <span class="fu">dv_xy</span>(attack_rate<span class="sc">$</span>start_zone, <span class="at">end =</span> <span class="st">&quot;lower&quot;</span>))</span>
<span id="cb30-14"><a href="court-plots.html#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="do">## additionally specify the subzone to dv_xy if you want to plot by subzone (and your data</span></span>
<span id="cb30-15"><a href="court-plots.html#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   were scouted with subzones)</span></span>
<span id="cb30-16"><a href="court-plots.html#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="court-plots.html#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="do">## for team 2, these need to be on the top half of the diagram</span></span>
<span id="cb30-18"><a href="court-plots.html#cb30-18" aria-hidden="true" tabindex="-1"></a>tm2i <span class="ot">&lt;-</span> attack_rate<span class="sc">$</span>team <span class="sc">==</span> <span class="fu">teams</span>(x)[<span class="dv">2</span>]</span>
<span id="cb30-19"><a href="court-plots.html#cb30-19" aria-hidden="true" tabindex="-1"></a>attack_rate[tm2i, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)] <span class="ot">&lt;-</span> <span class="fu">dv_flip_xy</span>(attack_rate[tm2i, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)])</span>
<span id="cb30-20"><a href="court-plots.html#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="court-plots.html#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(attack_rate, <span class="fu">aes</span>(x, y, <span class="at">fill =</span> rate)) <span class="sc">+</span> <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="fu">teams</span>(x)) <span class="sc">+</span></span>
<span id="cb30-22"><a href="court-plots.html#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">name =</span> <span class="st">&quot;Attack rate&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/cp1-1.png" width="672" /></p>
</div>
<div id="plotting-by-cone" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Plotting by cone<a href="court-plots.html#plotting-by-cone" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When scouting by cones, attacks are recorded as a direction (angle) rather than an ending point (zone or subzone). Let’s first make an attack chart of cones using arrows to indicate the direction, and varying the width and colour of the line according to the number of attacks made in each direction:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="court-plots.html#cb31-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">dv_read</span>(<span class="fu">ovdata_example</span>(<span class="st">&quot;190301_kats_beds&quot;</span>))</span>
<span id="cb31-2"><a href="court-plots.html#cb31-2" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="fu">plays</span>(x)</span>
<span id="cb31-3"><a href="court-plots.html#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="court-plots.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="do">## select left-side (X5) attacks</span></span>
<span id="cb31-5"><a href="court-plots.html#cb31-5" aria-hidden="true" tabindex="-1"></a>attack_rate <span class="ot">&lt;-</span> px <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(attack_code <span class="sc">==</span> <span class="st">&quot;X5&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="court-plots.html#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(start_zone, end_cone) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n_attacks =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="court-plots.html#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rate =</span> n_attacks<span class="sc">/</span><span class="fu">sum</span>(n_attacks)) <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb31-8"><a href="court-plots.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="do">## add starting locations</span></span>
<span id="cb31-9"><a href="court-plots.html#cb31-9" aria-hidden="true" tabindex="-1"></a>attack_rate <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(attack_rate, <span class="fu">dv_xy</span>(attack_rate<span class="sc">$</span>start_zone, <span class="at">end =</span> <span class="st">&quot;lower&quot;</span>))</span>
<span id="cb31-10"><a href="court-plots.html#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="do">## and end locations</span></span>
<span id="cb31-11"><a href="court-plots.html#cb31-11" aria-hidden="true" tabindex="-1"></a>attack_rate <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(attack_rate, <span class="fu">dv_cone2xy</span>(<span class="at">start_zones =</span> attack_rate<span class="sc">$</span>start_zone,</span>
<span id="cb31-12"><a href="court-plots.html#cb31-12" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">end_cones =</span> attack_rate<span class="sc">$</span>end_cone, <span class="at">end =</span> <span class="st">&quot;upper&quot;</span>))</span>
<span id="cb31-13"><a href="court-plots.html#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="court-plots.html#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(attack_rate, <span class="fu">aes</span>(x, y, <span class="at">xend =</span> ex, <span class="at">yend =</span> ey, <span class="at">colour =</span> rate, <span class="at">size =</span> rate)) <span class="sc">+</span></span>
<span id="cb31-15"><a href="court-plots.html#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb31-16"><a href="court-plots.html#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">angle =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb31-17"><a href="court-plots.html#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;OrRd&quot;</span>, <span class="at">direction =</span> <span class="dv">1</span>, <span class="at">name =</span> <span class="st">&quot;Attack rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-18"><a href="court-plots.html#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/cp_cones1-1.png" width="672" /></p>
<p>Or we can plot the cones using their polygons:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="court-plots.html#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="court-plots.html#cb32-2" aria-hidden="true" tabindex="-1"></a>cxy <span class="ot">&lt;-</span> <span class="fu">dv_cone2xy</span>(<span class="at">start_zones =</span> attack_rate<span class="sc">$</span>start_zone, <span class="at">end_cones =</span> attack_rate<span class="sc">$</span>end_cone,</span>
<span id="cb32-3"><a href="court-plots.html#cb32-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">as =</span> <span class="st">&quot;polygons&quot;</span>)</span>
<span id="cb32-4"><a href="court-plots.html#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="court-plots.html#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="do">## this returns coordinates as list columns, unpack these to use with ggplot</span></span>
<span id="cb32-6"><a href="court-plots.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  also add an identifier for each polygon</span></span>
<span id="cb32-7"><a href="court-plots.html#cb32-7" aria-hidden="true" tabindex="-1"></a>cxy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cx =</span> <span class="fu">unlist</span>(cxy<span class="sc">$</span>ex), <span class="at">cy =</span> <span class="fu">unlist</span>(cxy<span class="sc">$</span>ey),</span>
<span id="cb32-8"><a href="court-plots.html#cb32-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">id =</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(cxy)), rep, <span class="dv">4</span>)))</span>
<span id="cb32-9"><a href="court-plots.html#cb32-9" aria-hidden="true" tabindex="-1"></a>attack_rate <span class="ot">&lt;-</span> attack_rate <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(cxy, <span class="at">by =</span> <span class="st">&quot;id&quot;</span>)</span>
<span id="cb32-10"><a href="court-plots.html#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="court-plots.html#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(attack_rate, <span class="fu">aes</span>(cx, cy, <span class="at">group =</span> id, <span class="at">fill =</span> rate)) <span class="sc">+</span></span>
<span id="cb32-12"><a href="court-plots.html#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="court-plots.html#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>() <span class="sc">+</span></span>
<span id="cb32-14"><a href="court-plots.html#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;OrRd&quot;</span>, <span class="at">direction =</span> <span class="dv">1</span>, <span class="at">name =</span> <span class="st">&quot;Attack rate&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/cp_cones2-1.png" width="672" /></p>
</div>
<div id="plotting-by-line-segment" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Plotting by line segment<a href="court-plots.html#plotting-by-line-segment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Line segments can be used with zones/subzones, cones (as in the example above), or coordinates.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="court-plots.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## take just the serves from the play-by-play data</span></span>
<span id="cb33-2"><a href="court-plots.html#cb33-2" aria-hidden="true" tabindex="-1"></a>xserves <span class="ot">&lt;-</span> <span class="fu">subset</span>(px, skill <span class="sc">==</span> <span class="st">&quot;Serve&quot;</span>)</span>
<span id="cb33-3"><a href="court-plots.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="court-plots.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="do">## if the file had been scouted with coordinates included, we could plot them directly</span></span>
<span id="cb33-5"><a href="court-plots.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="do">## this file has no coordinates, so we&#39;ll fake some up for demo purposes</span></span>
<span id="cb33-6"><a href="court-plots.html#cb33-6" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">dv_fake_coordinates</span>(<span class="st">&quot;serve&quot;</span>, xserves<span class="sc">$</span>evaluation)</span>
<span id="cb33-7"><a href="court-plots.html#cb33-7" aria-hidden="true" tabindex="-1"></a>xserves[, <span class="fu">c</span>(<span class="st">&quot;start_coordinate&quot;</span>, <span class="st">&quot;start_coordinate_x&quot;</span>, <span class="st">&quot;start_coordinate_y&quot;</span>,</span>
<span id="cb33-8"><a href="court-plots.html#cb33-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;end_coordinate&quot;</span>, <span class="st">&quot;end_coordinate_x&quot;</span>, <span class="st">&quot;end_coordinate_y&quot;</span>)] <span class="ot">&lt;-</span> coords</span>
<span id="cb33-9"><a href="court-plots.html#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="court-plots.html#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="do">## now we can plot these</span></span>
<span id="cb33-11"><a href="court-plots.html#cb33-11" aria-hidden="true" tabindex="-1"></a>xserves<span class="sc">$</span>evaluation[<span class="sc">!</span>xserves<span class="sc">$</span>evaluation <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Ace&quot;</span>, <span class="st">&quot;Error&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb33-12"><a href="court-plots.html#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="court-plots.html#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xserves, <span class="fu">aes</span>(start_coordinate_x, start_coordinate_y,</span>
<span id="cb33-14"><a href="court-plots.html#cb33-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">xend =</span> end_coordinate_x, <span class="at">yend =</span> end_coordinate_y, <span class="at">colour =</span> evaluation)) <span class="sc">+</span></span>
<span id="cb33-15"><a href="court-plots.html#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">angle =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb33-16"><a href="court-plots.html#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Ace =</span> <span class="st">&quot;limegreen&quot;</span>, <span class="at">Error =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="at">Other =</span> <span class="st">&quot;dodgerblue&quot;</span>),</span>
<span id="cb33-17"><a href="court-plots.html#cb33-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name =</span> <span class="st">&quot;Evaluation&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-18"><a href="court-plots.html#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Serving team&quot;</span>, <span class="st">&quot;Receiving team&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/cp2-1.png" width="672" /></p>
</div>
<div id="heatmaps" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Heatmaps<a href="court-plots.html#heatmaps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Heatmap-style plots can be generated using a kernel density estimator. This takes a discrete number of location observations and attempts to estimate their corresponding (continuous) distribution across the court.</p>
<p>For example, take these attack ending coordinates:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="court-plots.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(px2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(skill <span class="sc">==</span> <span class="st">&quot;Attack&quot;</span>), <span class="fu">aes</span>(end_coordinate_x, end_coordinate_y)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="court-plots.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">court =</span> <span class="st">&quot;upper&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-3"><a href="court-plots.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/hm2-1.png" width="672" /></p>
<p>As a heatmap, using the <code>ovlytics::ov_heatmap_kde</code> function:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="court-plots.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ovlytics)</span>
<span id="cb35-2"><a href="court-plots.html#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="court-plots.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="do">## first generate the heatmap kernel density estimate</span></span>
<span id="cb35-4"><a href="court-plots.html#cb35-4" aria-hidden="true" tabindex="-1"></a>hx <span class="ot">&lt;-</span> <span class="fu">ov_heatmap_kde</span>(px2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(skill <span class="sc">==</span> <span class="st">&quot;Attack&quot;</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(end_coordinate_x, end_coordinate_y),</span>
<span id="cb35-5"><a href="court-plots.html#cb35-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">resolution =</span> <span class="st">&quot;coordinates&quot;</span>, <span class="at">court =</span> <span class="st">&quot;upper&quot;</span>)</span>
<span id="cb35-6"><a href="court-plots.html#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="court-plots.html#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="do">## then plot it</span></span>
<span id="cb35-8"><a href="court-plots.html#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hx, <span class="fu">aes</span>(x, y, <span class="at">fill =</span> density)) <span class="sc">+</span></span>
<span id="cb35-9"><a href="court-plots.html#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>, <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-10"><a href="court-plots.html#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>() <span class="sc">+</span></span>
<span id="cb35-11"><a href="court-plots.html#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">court =</span> <span class="st">&quot;upper&quot;</span>) <span class="do">## plot the court last, so that the lines overlay the heatmap</span></span></code></pre></div>
<p><img src="_main_files/figure-html/hm3a-1.png" width="672" /></p>
<p>The smoothness of the heatmap is automatically set depending on the <code>resolution</code> value (“subzones” or “coordinates”), but can be controlled by the <code>bw</code> parameter in <code>ov_heatmap_kde</code> if you wish to change it. You can alternatively use <code>stat_density_2d</code> to generate the density estimate:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="court-plots.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(px2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(skill <span class="sc">==</span> <span class="st">&quot;Attack&quot;</span>), <span class="fu">aes</span>(end_coordinate_x, end_coordinate_y)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="court-plots.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_2d</span>(<span class="at">geom =</span> <span class="st">&quot;raster&quot;</span>, <span class="fu">aes_string</span>(<span class="at">fill =</span> <span class="st">&quot;..density..&quot;</span>), <span class="at">contour =</span> <span class="cn">FALSE</span>, <span class="at">h =</span> <span class="fl">0.85</span>, <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="court-plots.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>, <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="court-plots.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">court =</span> <span class="st">&quot;upper&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/hm3b-1.png" width="672" /></p>
<p>If you need more control over the heatmap, you may need to call e.g. <code>MASS::kde2d()</code> directly to construct the density estimate and plot it with <code>geom_raster</code>.</p>
</div>
<div id="changing-direction" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Changing direction<a href="court-plots.html#changing-direction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Coordinates might not appear in the dvw file in any particular orientation (i.e. starting consistently on one side of the court).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="court-plots.html#cb37-1" aria-hidden="true" tabindex="-1"></a>xattack <span class="ot">&lt;-</span> px2 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(skill <span class="sc">==</span> <span class="st">&quot;Attack&quot;</span>)</span>
<span id="cb37-2"><a href="court-plots.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xattack, <span class="fu">aes</span>(start_coordinate_x, start_coordinate_y, <span class="at">xend =</span> end_coordinate_x, <span class="at">yend =</span> end_coordinate_y)) <span class="sc">+</span> <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="court-plots.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/coordflip1-1.png" width="672" /></p>
<p>If we wish to plot all attacks so that they start on the same side of the court, we first need to figure out which ones need to be flipped around. The centre line of the court is at <code>y = 3.5</code>, so we can find any attacks that start on the upper side:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="court-plots.html#cb38-1" aria-hidden="true" tabindex="-1"></a>toflip <span class="ot">&lt;-</span> <span class="fu">which</span>(xattack<span class="sc">$</span>start_coordinate_y <span class="sc">&gt;</span> <span class="fl">3.5</span>)</span></code></pre></div>
<p>And then flip just those attacks so that they start on the lower half of the court:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="court-plots.html#cb39-1" aria-hidden="true" tabindex="-1"></a>xattack<span class="sc">$</span>start_coordinate_x[toflip] <span class="ot">&lt;-</span> <span class="fu">dv_flip_x</span>(xattack<span class="sc">$</span>start_coordinate_x[toflip])</span>
<span id="cb39-2"><a href="court-plots.html#cb39-2" aria-hidden="true" tabindex="-1"></a>xattack<span class="sc">$</span>start_coordinate_y[toflip] <span class="ot">&lt;-</span> <span class="fu">dv_flip_y</span>(xattack<span class="sc">$</span>start_coordinate_y[toflip])</span>
<span id="cb39-3"><a href="court-plots.html#cb39-3" aria-hidden="true" tabindex="-1"></a>xattack<span class="sc">$</span>mid_coordinate_x[toflip] <span class="ot">&lt;-</span> <span class="fu">dv_flip_x</span>(xattack<span class="sc">$</span>mid_coordinate_x[toflip])</span>
<span id="cb39-4"><a href="court-plots.html#cb39-4" aria-hidden="true" tabindex="-1"></a>xattack<span class="sc">$</span>mid_coordinate_y[toflip] <span class="ot">&lt;-</span> <span class="fu">dv_flip_y</span>(xattack<span class="sc">$</span>mid_coordinate_y[toflip])</span>
<span id="cb39-5"><a href="court-plots.html#cb39-5" aria-hidden="true" tabindex="-1"></a>xattack<span class="sc">$</span>end_coordinate_x[toflip] <span class="ot">&lt;-</span> <span class="fu">dv_flip_x</span>(xattack<span class="sc">$</span>end_coordinate_x[toflip])</span>
<span id="cb39-6"><a href="court-plots.html#cb39-6" aria-hidden="true" tabindex="-1"></a>xattack<span class="sc">$</span>end_coordinate_y[toflip] <span class="ot">&lt;-</span> <span class="fu">dv_flip_y</span>(xattack<span class="sc">$</span>end_coordinate_y[toflip])</span></code></pre></div>
<p>Or a little more succinctly using dplyr functions:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="court-plots.html#cb40-1" aria-hidden="true" tabindex="-1"></a>xattack[toflip, ] <span class="ot">&lt;-</span> xattack[toflip, ] <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="court-plots.html#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">&quot;start_coordinate_x&quot;</span>, <span class="st">&quot;mid_coordinate_x&quot;</span>, <span class="st">&quot;end_coordinate_x&quot;</span>)), dv_flip_x),</span>
<span id="cb40-3"><a href="court-plots.html#cb40-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">across</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(<span class="st">&quot;start_coordinate_y&quot;</span>, <span class="st">&quot;mid_coordinate_y&quot;</span>, <span class="st">&quot;end_coordinate_y&quot;</span>)), dv_flip_y))</span></code></pre></div>
<p>Now plot it:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="court-plots.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xattack, <span class="fu">aes</span>(start_coordinate_x, start_coordinate_y, <span class="at">xend =</span> end_coordinate_x, <span class="at">yend =</span> end_coordinate_y)) <span class="sc">+</span> <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb41-2"><a href="court-plots.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/coordflip5-1.png" width="672" /></p>
</div>
<div id="plotting-mid-coordinates" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Plotting mid-coordinates<a href="court-plots.html#plotting-mid-coordinates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>mid</code> coordinates can be used by the scout to indicate e.g. an attack that deflected off the block. In these cases, it can be misleading to plot just the start and end locations connected by a straight line segment. Consider an attack that came off the block and went back into the attacker’s court — by plotting just the start and end points it would appear to go directly backwards.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="court-plots.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## example data</span></span>
<span id="cb42-2"><a href="court-plots.html#cb42-2" aria-hidden="true" tabindex="-1"></a>px2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">start_coordinate_x =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.8</span>), <span class="at">start_coordinate_y =</span> <span class="fu">c</span>(<span class="fl">3.25</span>, <span class="fl">3.25</span>),</span>
<span id="cb42-3"><a href="court-plots.html#cb42-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">mid_coordinate_x =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">1.4</span>), <span class="at">mid_coordinate_y =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">3.5</span>),</span>
<span id="cb42-4"><a href="court-plots.html#cb42-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">end_coordinate_x =</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="dv">2</span>), <span class="at">end_coordinate_y =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb42-5"><a href="court-plots.html#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="court-plots.html#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(px2, <span class="fu">aes</span>(start_coordinate_x, start_coordinate_y, <span class="at">xend =</span> end_coordinate_x, <span class="at">yend =</span> end_coordinate_y)) <span class="sc">+</span> <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="court-plots.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb42-8"><a href="court-plots.html#cb42-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">ends =</span> <span class="st">&quot;last&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/midcoord-1.png" width="672" /></p>
<p>In these cases it is better to plot the mid point as well, but we need to cope with the fact that some mid-coordinates will be missing (<code>NA</code>):</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="court-plots.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(px2, <span class="fu">aes</span>(start_coordinate_x, start_coordinate_y, <span class="at">xend =</span> end_coordinate_x, <span class="at">yend =</span> end_coordinate_y)) <span class="sc">+</span> <span class="fu">ggcourt</span>(<span class="at">labels =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb43-2"><a href="court-plots.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## lines with no midpoint</span></span>
<span id="cb43-3"><a href="court-plots.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> px2[<span class="fu">is.na</span>(px2<span class="sc">$</span>mid_coordinate_x), ], <span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb43-4"><a href="court-plots.html#cb43-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">ends =</span> <span class="st">&quot;last&quot;</span>)) <span class="sc">+</span></span>
<span id="cb43-5"><a href="court-plots.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## start to mid for lines with midpoint, no ending arrow</span></span>
<span id="cb43-6"><a href="court-plots.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> px2[<span class="sc">!</span><span class="fu">is.na</span>(px2<span class="sc">$</span>mid_coordinate_x), ], <span class="fu">aes</span>(<span class="at">xend =</span> mid_coordinate_x, <span class="at">yend =</span> mid_coordinate_y), <span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="court-plots.html#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## mid to end for lines with midpoint</span></span>
<span id="cb43-8"><a href="court-plots.html#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> px2[<span class="sc">!</span><span class="fu">is.na</span>(px2<span class="sc">$</span>mid_coordinate_x), ], <span class="fu">aes</span>(<span class="at">x =</span> mid_coordinate_x, <span class="at">y =</span> mid_coordinate_y), <span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb43-9"><a href="court-plots.html#cb43-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">type =</span> <span class="st">&quot;closed&quot;</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">ends =</span> <span class="st">&quot;last&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/midcoord2-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="indicators-and-statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="live-scouting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
